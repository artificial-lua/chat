<!DOCTYPE html>
<html lang="ko">
<head> 
    <meta charset="UTF-8">
    <title>Form</title>
</head>
<body>
    <h1>웹소켓 테스트</h1>

    <!--create TextArea to recive messages log-->
    <textarea id="log" rows="10" cols="50"></textarea>
    
    <!--create input message box-->
    <form>
        <input type="text" name="message" placeholder="메시지를 입력하세요." id="message">
        <input type="button" id="btn_send" value="전송">
        <button id="btn_close">close</button>
    <!-- create two buttons -->
</body>
</html>
<script>
    // create websocket client by 30000 port
    const ws = new WebSocket('ws://localhost:30000');
    // when connection is opened
    ws.onopen = function() {
        console.log('connection is opened');
    };
    // when message is received
    ws.onmessage = function(e) {
        console.log(e.data);
        // append message to log
        document.getElementById('log').value += e.data + '\n';

    };
    // when connection is closed
    ws.onclose = function() {
        console.log('connection is closed');
    };
    // when error occurs
    ws.onerror = function(e) {
        console.log('error occurs');
    };
    // when send button is clicked
    document.getElementById('btn_send').onclick = function() {
        // if message is not empty
        if (document.getElementById('message').value != '') {
            // send message
            ws.send(document.getElementById('message').value);
            // clear message box
            document.getElementById('message').value = '';
        }
    };
    // when close button is clicked
    document.getElementById('btn_close').onclick = function() {
        // close connection
        ws.close();
    };
</script>